--- a/drivers/gpu/drm/drm_gem_cma_helper.c	2019-11-11 19:23:21.617499000 +0900
+++ b/drivers/gpu/drm/drm_gem_cma_helper.c	2019-11-13 18:20:43.157218963 +0900
@@ -23,6 +23,9 @@
 #include <linux/export.h>
 #include <linux/dma-buf.h>
 #include <linux/dma-mapping.h>
+#ifdef CONFIG_PDJ
+#include <linux/delay.h>
+#endif
 
 #include <drm/drmP.h>
 #include <drm/drm.h>
@@ -101,19 +104,27 @@ struct drm_gem_cma_object *drm_gem_cma_c
 					      size_t size)
 {
 	struct drm_gem_cma_object *cma_obj;
-	int ret;
+	int ret = 3;
 
 	size = round_up(size, PAGE_SIZE);
 
 	cma_obj = __drm_gem_cma_create(drm, size);
 	if (IS_ERR(cma_obj))
 		return cma_obj;
-
+#ifdef CONFIG_PDJ
+retry_alloc:
+#endif
 	cma_obj->vaddr = dma_alloc_wc(drm->dev, size, &cma_obj->paddr,
 				      GFP_KERNEL | __GFP_NOWARN);
 	if (!cma_obj->vaddr) {
 		dev_err(drm->dev, "failed to allocate buffer with size %zu\n",
 			size);
+#ifdef CONFIG_PDJ
+		if (--ret > 0) {
+			msleep(50);
+			goto retry_alloc;
+		}
+#endif
 		ret = -ENOMEM;
 		goto error;
 	}
